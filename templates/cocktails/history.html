{% extends 'base.html' %}

{% block title %}Mes cocktails - Le Mixologue Augment√©{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto py-4 sm:py-6 px-4 sm:px-6 lg:px-8">
    <!-- Header am√©lior√© -->
    <div class="bg-gradient-to-br from-cocktail-primary to-purple-700 rounded-2xl shadow-2xl p-6 sm:p-8 mb-8 text-white">
        <div class="flex flex-col lg:flex-row lg:justify-between lg:items-start">
            <div class="mb-6 lg:mb-0 flex-1 lg:mr-8">
                <!-- Header avec titre et collapse sur mobile -->
                <button id="mobile-stats-toggle" class="flex items-center justify-between w-full sm:pointer-events-none mb-4" type="button">
                    <div class="flex items-center">
                        <div class="bg-white bg-opacity-20 rounded-full p-3 mr-4">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-3xl sm:text-4xl font-bold">üçπ Mes Cr√©ations</h1>
                            <div class="flex items-center mt-2 text-purple-100">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                                <p class="text-lg">Vos cocktails cr√©√©s avec l'IA</p>
                            </div>
                        </div>
                    </div>
                    <!-- Chevron pour mobile seulement -->
                    <div class="sm:hidden">
                        <svg id="stats-chevron" class="w-6 h-6 text-white transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </div>
                </button>
                
                <!-- Stats rapides avec bouton cr√©er - Collapsibles sur mobile -->
                <div id="stats-content" class="stats-content">
                    <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-5 gap-4">
                        <div class="bg-white bg-opacity-10 rounded-lg p-3 text-center backdrop-blur-sm">
                            <div class="text-2xl font-bold">{{ total_cocktails }}</div>
                            <div class="text-xs text-purple-100">Total</div>
                        </div>
                        <div class="bg-white bg-opacity-10 rounded-lg p-3 text-center backdrop-blur-sm">
                            <div class="text-2xl font-bold">{{ favorite_cocktails }}</div>
                            <div class="text-xs text-purple-100">Favoris</div>
                        </div>
                        <div class="bg-white bg-opacity-10 rounded-lg p-3 text-center backdrop-blur-sm">
                            <div class="text-2xl font-bold">{{ cocktails_with_alcohol }}</div>
                            <div class="text-xs text-purple-100">Avec alcool</div>
                        </div>
                        <div class="bg-white bg-opacity-10 rounded-lg p-3 text-center backdrop-blur-sm">
                            <div class="text-2xl font-bold">{{ cocktails_without_alcohol }}</div>
                            <div class="text-xs text-purple-100">Sans alcool</div>
                        </div>
                        <!-- Bouton cr√©er int√©gr√© comme 5√®me stat -->
                        <div class="col-span-2 sm:col-span-4 lg:col-span-1 flex justify-center">
                            <a href="{% url 'cocktails:generate' %}" 
                               class="group relative bg-white bg-opacity-10 backdrop-blur-sm hover:bg-opacity-20 text-white rounded-lg p-3 text-center shadow-lg transform hover:scale-105 transition-all duration-300 border border-white border-opacity-20 w-full"
                               title="Cr√©er un nouveau cocktail">
                                <div class="absolute inset-0 bg-gradient-to-r from-cocktail-secondary to-yellow-400 rounded-lg opacity-0 group-hover:opacity-20 transition-opacity duration-300"></div>
                                <div class="relative z-10">
                                    <svg class="w-6 h-6 mx-auto mb-2 group-hover:rotate-90 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                    <div class="text-xs text-purple-100 leading-tight">Cr√©er un nouveau cocktail</div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-6 sm:p-8 mb-8 backdrop-blur-sm">
        <!-- Header des filtres -->
        <div class="flex items-center justify-between mb-6">
            <button id="mobile-filters-toggle" class="flex items-center w-full sm:w-auto sm:pointer-events-none" type="button">
                <div class="bg-gradient-to-r from-cocktail-primary to-purple-600 rounded-full p-2 mr-3">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"></path>
                    </svg>
                </div>
                <div class="flex-1">
                    <h2 class="text-lg font-bold text-gray-800 text-left">Filtres & Tri</h2>
                    <p class="text-sm text-gray-500 text-left">Personnalisez votre vue</p>
                </div>
                <!-- Ic√¥ne collapse (mobile seulement) -->
                <div class="sm:hidden">
                    <svg id="filters-chevron" class="w-5 h-5 text-gray-500 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
            </button>
            
            <!-- Compteur de r√©sultats -->
            <div class="hidden sm:flex items-center bg-gradient-to-r from-blue-50 to-indigo-50 px-4 py-2 rounded-full border border-blue-200">
                <svg class="w-4 h-4 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                <span class="text-sm font-semibold text-blue-700">
                    {% if current_filter != 'all' %}{{ filtered_count }}{% else %}{{ total_cocktails }}{% endif %} r√©sultat{{ total_cocktails|pluralize }}
                </span>
            </div>
        </div>
        
        <!-- Contenu collapsible -->
        <div id="filters-content" class="filters-content space-y-6">
            <!-- Section Filtres - Tous les filtres ensemble -->
            <div>
                <h3 class="text-sm font-semibold text-gray-700 mb-4 flex items-center">
                    <span class="w-2 h-2 bg-cocktail-primary rounded-full mr-2"></span>
                    Cat√©gories & Types de cocktails
                </h3>
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
                    <!-- Tous les cocktails -->
                    <a href="?filter=all{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}" 
                       class="filter-btn group relative {% if current_filter == 'all' %}bg-gradient-to-r from-cocktail-primary to-purple-600 text-white shadow-lg{% else %}bg-gray-50 hover:bg-gray-100 text-gray-700 hover:text-gray-900{% endif %} px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 {% if current_filter == 'all' %}border-purple-200{% else %}border-gray-200 hover:border-gray-300{% endif %}">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full {% if current_filter == 'all' %}bg-white bg-opacity-20{% else %}bg-gray-200{% endif %} flex items-center justify-center mr-3">
                                <span class="text-sm font-bold">üìä</span>
                            </div>
                            <div class="text-left">
                                <div class="leading-tight">Tous</div>
                                <div class="text-xs opacity-80">{{ total_cocktails }} cocktails</div>
                            </div>
                        </div>
                        {% if current_filter == 'all' %}
                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-pink-400 opacity-20 rounded-xl"></div>
                        {% endif %}
                    </a>
                    
                    <!-- Favoris -->
                    <a href="?filter=favorites{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}" 
                       class="filter-btn group relative {% if current_filter == 'favorites' %}bg-gradient-to-r from-red-500 to-pink-600 text-white shadow-lg{% else %}bg-gray-50 hover:bg-red-50 text-gray-700 hover:text-red-700{% endif %} px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 {% if current_filter == 'favorites' %}border-red-200{% else %}border-gray-200 hover:border-red-300{% endif %}">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full {% if current_filter == 'favorites' %}bg-white bg-opacity-20{% else %}bg-red-100{% endif %} flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 {% if current_filter == 'favorites' %}text-white{% else %}text-red-500{% endif %}" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                </svg>
                            </div>
                            <div class="text-left">
                                <div class="leading-tight">Favoris</div>
                                <div class="text-xs opacity-80">{{ favorite_cocktails }} cocktails</div>
                            </div>
                        </div>
                        {% if current_filter == 'favorites' %}
                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-pink-400 opacity-20 rounded-xl"></div>
                        {% endif %}
                    </a>
                    
                    <!-- Avec alcool -->
                    <a href="?filter=alcoholic{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}" 
                       class="filter-btn group relative {% if current_filter == 'alcoholic' %}bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg{% else %}bg-gray-50 hover:bg-orange-50 text-gray-700 hover:text-orange-700{% endif %} px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 {% if current_filter == 'alcoholic' %}border-orange-200{% else %}border-gray-200 hover:border-orange-300{% endif %}">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full {% if current_filter == 'alcoholic' %}bg-white bg-opacity-20{% else %}bg-orange-100{% endif %} flex items-center justify-center mr-3">
                                <span class="text-lg">üç∏</span>
                            </div>
                            <div class="text-left">
                                <div class="leading-tight">Avec alcool</div>
                                <div class="text-xs opacity-80">{{ cocktails_with_alcohol }} cocktails</div>
                            </div>
                        </div>
                        {% if current_filter == 'alcoholic' %}
                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-pink-400 opacity-20 rounded-xl"></div>
                        {% endif %}
                    </a>
                    
                    <!-- Sans alcool -->
                    <a href="?filter=non-alcoholic{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}" 
                       class="filter-btn group relative {% if current_filter == 'non-alcoholic' %}bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg{% else %}bg-gray-50 hover:bg-green-50 text-gray-700 hover:text-green-700{% endif %} px-4 py-3 rounded-xl text-sm font-semibold transition-all duration-300 hover:shadow-lg hover:scale-105 border-2 {% if current_filter == 'non-alcoholic' %}border-green-200{% else %}border-gray-200 hover:border-green-300{% endif %}">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full {% if current_filter == 'non-alcoholic' %}bg-white bg-opacity-20{% else %}bg-green-100{% endif %} flex items-center justify-center mr-3">
                                <span class="text-lg">ü•§</span>
                            </div>
                            <div class="text-left">
                                <div class="leading-tight">Sans alcool</div>
                                <div class="text-xs opacity-80">{{ cocktails_without_alcohol }} cocktails</div>
                            </div>
                        </div>
                        {% if current_filter == 'non-alcoholic' %}
                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-pink-400 opacity-20 rounded-xl"></div>
                        {% endif %}
                    </a>
                </div>
            </div>
            
            <!-- Section Tri -->
            <div class="pt-4 border-t border-gray-200">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                    <div class="flex items-center">
                        <div class="bg-gradient-to-r from-indigo-500 to-blue-600 rounded-full p-2 mr-3">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"></path>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-sm font-semibold text-gray-700">Options de tri</h3>
                            <p class="text-xs text-gray-500">Organisez vos cocktails</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center bg-white border-2 border-gray-200 rounded-xl p-1 shadow-inner">
                        <label for="sort-select" class="sr-only">Trier par</label>
                        <select id="sort-select" class="bg-transparent border-none outline-none px-4 py-2 text-sm font-medium text-gray-700 cursor-pointer focus:bg-gray-50 rounded-lg transition-colors">
                            <option value="date_desc" {% if current_sort == 'date_desc' %}selected{% endif %}>üïí Plus r√©cent d'abord</option>
                            <option value="date_asc" {% if current_sort == 'date_asc' %}selected{% endif %}>üìÖ Plus ancien d'abord</option>
                            <option value="name_asc" {% if current_sort == 'name_asc' %}selected{% endif %}>üî§ Nom A ‚Üí Z</option>
                            <option value="name_desc" {% if current_sort == 'name_desc' %}selected{% endif %}>üî§ Nom Z ‚Üí A</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- R√©sum√© du filtre actif -->
        {% if current_filter != 'all' %}
        <div class="mt-6 p-4 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 rounded-xl border border-blue-200">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mr-3">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div>
                        <p class="text-sm font-semibold text-blue-800">
                            Filtre actif : 
                            {% if current_filter == 'favorites' %}
                                <span class="text-red-600">Favoris ‚ù§Ô∏è</span>
                            {% elif current_filter == 'alcoholic' %}
                                <span class="text-orange-600">Avec alcool üç∏</span>
                            {% elif current_filter == 'non-alcoholic' %}
                                <span class="text-green-600">Sans alcool ü•§</span>
                            {% endif %}
                        </p>
                        <p class="text-xs text-blue-600">
                            <span class="font-bold">{{ filtered_count }}</span> cocktail{{ filtered_count|pluralize }} trouv√©{{ filtered_count|pluralize }}
                        </p>
                    </div>
                </div>
                
                <a href="?{% if current_sort != 'date_desc' %}sort={{ current_sort }}{% endif %}" 
                   class="text-xs bg-white hover:bg-gray-50 text-gray-600 hover:text-gray-800 px-3 py-2 rounded-lg border border-gray-300 transition-colors flex items-center">
                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                    Effacer le filtre
                </a>
            </div>
        </div>
        {% endif %}
        </div>
    </div>

    <!-- Liste des cocktails am√©lior√©e -->
    {% if cocktails %}
    <!-- Desktop Grid -->
    <div class="hidden sm:grid sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-6">
        {% for cocktail in cocktails %}
        <div class="cocktail-card group bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 overflow-hidden border border-gray-100" 
             data-alcohol="{{ cocktail.alcohol_content }}" 
             data-favorite="{{ cocktail.is_favorite|yesno:'true,false' }}">
            
            <!-- Image avec overlay -->
            <div class="relative h-48 bg-gradient-to-br from-cocktail-primary/20 to-cocktail-secondary/20 overflow-hidden">
                {% if cocktail.image_url %}
                    <img src="{{ MEDIA_URL }}{{ cocktail.image_url }}" 
                         alt="{{ cocktail.name }}" 
                         class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                {% else %}
                    <div class="w-full h-full flex items-center justify-center">
                        <div class="text-5xl group-hover:scale-110 transition-transform duration-300">üçπ</div>
                    </div>
                {% endif %}
                
                <!-- Badge overlay -->
                <div class="absolute top-3 left-3 flex gap-2">
                    {% if cocktail.difficulty_level == 'easy' %}
                        <span class="bg-green-500 text-white text-xs font-semibold px-2 py-1 rounded-full backdrop-blur-sm bg-opacity-90">‚ú® Facile</span>
                    {% elif cocktail.difficulty_level == 'medium' %}
                        <span class="bg-yellow-500 text-white text-xs font-semibold px-2 py-1 rounded-full backdrop-blur-sm bg-opacity-90">üî• Moyen</span>
                    {% else %}
                        <span class="bg-red-500 text-white text-xs font-semibold px-2 py-1 rounded-full backdrop-blur-sm bg-opacity-90">‚ö° Difficile</span>
                    {% endif %}
                </div>
                
                <!-- Bouton favori flottant -->
                <button class="absolute top-3 right-3 favorite-btn p-2 rounded-full bg-white bg-opacity-90 hover:bg-opacity-100 shadow-lg transition-all duration-200 hover:scale-110" 
                        data-cocktail-id="{{ cocktail.pk }}" 
                        data-is-favorite="{{ cocktail.is_favorite|yesno:'true,false' }}">
                    {% if cocktail.is_favorite %}
                        <svg class="w-4 h-4 fill-current text-red-500" viewBox="0 0 24 24">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                    {% else %}
                        <svg class="w-4 h-4 text-gray-400 hover:text-red-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    {% endif %}
                </button>
            </div>
            
            <div class="p-5">
                <!-- Header de la carte -->
                <div class="mb-3">
                    <h3 class="text-lg font-bold text-gray-900 line-clamp-2 group-hover:text-cocktail-primary transition-colors">{{ cocktail.name }}</h3>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        {{ cocktail.preparation_time }} min
                    </div>
                </div>
                
                <!-- Description -->
                <p class="text-gray-600 text-sm mb-3 line-clamp-2 leading-relaxed">{{ cocktail.description }}</p>
                
                <!-- Date de cr√©ation -->
                <div class="flex items-center mb-4 text-xs text-gray-500">
                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    Cr√©√© le {{ cocktail.created_at|date:"d/m/Y" }}
                </div>
                
                <!-- Caract√©ristiques -->
                <div class="flex flex-wrap gap-2 mb-4">
                    <!-- Badge alcool -->
                    {% if cocktail.alcohol_content == 'none' %}
                        <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                            ü•§ Sans alcool
                        </span>
                    {% elif cocktail.alcohol_content == 'low' %}
                        <span class="bg-yellow-100 text-yellow-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                            üçã L√©ger
                        </span>
                    {% elif cocktail.alcohol_content == 'medium' %}
                        <span class="bg-orange-100 text-orange-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                            üç∏ Mod√©r√©
                        </span>
                    {% else %}
                        <span class="bg-red-100 text-red-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                            üî• Fort
                        </span>
                    {% endif %}
                </div>
                
                <!-- Ingr√©dients aper√ßu -->
                <div class="mb-4">
                    <p class="text-xs text-gray-500 mb-1 font-medium">Ingr√©dients principaux :</p>
                    <p class="text-sm text-gray-700 truncate">
                        {% for ingredient in cocktail.ingredients|slice:":3" %}
                            {{ ingredient.nom }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                        {% if cocktail.ingredients|length > 3 %}
                            <span class="text-cocktail-primary font-medium">+{{ cocktail.ingredients|length|add:"-3" }} autres</span>
                        {% endif %}
                    </p>
                </div>
                
                <!-- Footer de la carte -->
                <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                    <a href="{% url 'cocktails:cocktail_detail' pk=cocktail.pk %}" 
                       class="bg-cocktail-primary hover:bg-purple-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors">
                        Voir d√©tails
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- Mobile Carousel -->
    <div class="block sm:hidden">
        <div class="relative">
            <!-- Carousel Container -->
            <div id="cocktail-carousel" class="overflow-hidden rounded-2xl">
                <div id="carousel-track" class="flex transition-transform duration-300 ease-in-out">
                    {% for cocktail in all_cocktails %}
                    <div class="w-full flex-shrink-0 px-3">
                        <div class="cocktail-card group bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100" 
                             data-alcohol="{{ cocktail.alcohol_content }}" 
                             data-favorite="{{ cocktail.is_favorite|yesno:'true,false' }}">
                            
                            <!-- Image avec overlay -->
                            <div class="relative h-48 bg-gradient-to-br from-cocktail-primary/20 to-cocktail-secondary/20 overflow-hidden">
                                {% if cocktail.image_url %}
                                    <img src="{{ MEDIA_URL }}{{ cocktail.image_url }}" 
                                         alt="{{ cocktail.name }}" 
                                         class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                                {% else %}
                                    <div class="w-full h-full flex items-center justify-center">
                                        <div class="text-5xl group-hover:scale-110 transition-transform duration-300">üçπ</div>
                                    </div>
                                {% endif %}
                                
                                <!-- Badge overlay -->
                                <div class="absolute top-3 left-3 flex gap-2">
                                    {% if cocktail.difficulty_level == 'easy' %}
                                        <span class="bg-green-500 text-white text-xs font-semibold px-2 py-1 rounded-full backdrop-blur-sm bg-opacity-90">‚ú® Facile</span>
                                    {% elif cocktail.difficulty_level == 'medium' %}
                                        <span class="bg-yellow-500 text-white text-xs font-semibold px-2 py-1 rounded-full backdrop-blur-sm bg-opacity-90">üî• Moyen</span>
                                    {% else %}
                                        <span class="bg-red-500 text-white text-xs font-semibold px-2 py-1 rounded-full backdrop-blur-sm bg-opacity-90">‚ö° Difficile</span>
                                    {% endif %}
                                </div>
                                
                                <!-- Bouton favori flottant -->
                                <button class="absolute top-3 right-3 favorite-btn p-2 rounded-full bg-white bg-opacity-90 hover:bg-opacity-100 shadow-lg transition-all duration-200 hover:scale-110" 
                                        data-cocktail-id="{{ cocktail.pk }}" 
                                        data-is-favorite="{{ cocktail.is_favorite|yesno:'true,false' }}">
                                    {% if cocktail.is_favorite %}
                                        <svg class="w-4 h-4 fill-current text-red-500" viewBox="0 0 24 24">
                                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                        </svg>
                                    {% else %}
                                        <svg class="w-4 h-4 text-gray-400 hover:text-red-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                        </svg>
                                    {% endif %}
                                </button>
                            </div>
                            
                            <div class="p-5">
                            <!-- Header de la carte -->
                            <div class="mb-3">
                                <h3 class="text-lg font-bold text-gray-900 line-clamp-2 group-hover:text-cocktail-primary transition-colors">{{ cocktail.name }}</h3>
                                <div class="flex items-center mt-2 text-xs text-gray-500">
                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    {{ cocktail.preparation_time }} min
                                </div>
                            </div>
                            
                            <!-- Description -->
                            <p class="text-gray-600 text-sm mb-3 line-clamp-2 leading-relaxed">{{ cocktail.description }}</p>
                            
                            <!-- Date de cr√©ation -->
                            <div class="flex items-center mb-4 text-xs text-gray-500">
                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                Cr√©√© le {{ cocktail.created_at|date:"d/m/Y" }}
                            </div>                                <!-- Caract√©ristiques -->
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <!-- Badge alcool -->
                                    {% if cocktail.alcohol_content == 'none' %}
                                        <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                                            ü•§ Sans alcool
                                        </span>
                                    {% elif cocktail.alcohol_content == 'low' %}
                                        <span class="bg-yellow-100 text-yellow-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                                            üçã L√©ger
                                        </span>
                                    {% elif cocktail.alcohol_content == 'medium' %}
                                        <span class="bg-orange-100 text-orange-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                                            üç∏ Mod√©r√©
                                        </span>
                                    {% else %}
                                        <span class="bg-red-100 text-red-800 text-xs font-semibold px-3 py-1 rounded-full flex items-center">
                                            üî• Fort
                                        </span>
                                    {% endif %}
                                </div>
                                
                                <!-- Ingr√©dients aper√ßu -->
                                <div class="mb-4">
                                    <p class="text-xs text-gray-500 mb-1 font-medium">Ingr√©dients principaux :</p>
                                    <p class="text-sm text-gray-700 truncate">
                                        {% for ingredient in cocktail.ingredients|slice:":3" %}
                                            {{ ingredient.nom }}{% if not forloop.last %}, {% endif %}
                                        {% endfor %}
                                        {% if cocktail.ingredients|length > 3 %}
                                            <span class="text-cocktail-primary font-medium">+{{ cocktail.ingredients|length|add:"-3" }} autres</span>
                                        {% endif %}
                                    </p>
                                </div>
                                
                                <!-- Footer de la carte -->
                                <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                                    <a href="{% url 'cocktails:cocktail_detail' pk=cocktail.pk %}" 
                                       class="bg-cocktail-primary hover:bg-purple-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors">
                                        Voir d√©tails
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Navigation arrows -->
            {% if all_cocktails|length > 1 %}
            <button id="prev-btn" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 shadow-lg transition-all duration-200 hover:scale-110 z-10">
                <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>
            <button id="next-btn" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 shadow-lg transition-all duration-200 hover:scale-110 z-10">
                <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
            {% endif %}
        </div>
        
        <!-- Mobile carousel info - Style tendance -->
        <div class="mt-6 text-center">
            <div class="inline-flex items-center bg-gradient-to-r from-cocktail-primary to-purple-600 text-white px-6 py-3 rounded-full shadow-lg backdrop-blur-sm">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                        <span class="text-sm font-bold" id="current-slide-number">1</span>
                    </div>
                    <div class="h-6 w-px bg-white bg-opacity-30"></div>
                    <div class="text-sm font-medium">
                        <span class="opacity-80">sur</span> 
                        <span class="font-bold" id="total-slides">{{ all_cocktails|length }}</span> 
                        <span class="opacity-80">cocktails</span>
                    </div>
                </div>
            </div>
            
            <!-- Progress bar -->
            <div class="mt-4 max-w-xs mx-auto">
                <div class="w-full bg-gray-200 rounded-full h-1 overflow-hidden">
                    <div id="progress-bar" class="h-full bg-gradient-to-r from-cocktail-primary to-purple-600 rounded-full transition-all duration-300 ease-out" 
                         style="width: 0%"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pagination (Desktop only) -->
    {% if cocktails.has_other_pages %}
    <div class="mt-8 flex justify-center hidden sm:flex">
        <nav class="flex items-center space-x-2">
            {% if cocktails.has_previous %}
                <a href="?page={{ cocktails.previous_page_number }}{% if current_filter != 'all' %}&filter={{ current_filter }}{% endif %}{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}&page_size={{ current_page_size }}" 
                   class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700">
                    Pr√©c√©dent
                </a>
            {% endif %}
            
            {% for num in cocktails.paginator.page_range %}
                {% if cocktails.number == num %}
                    <span class="px-3 py-2 text-sm font-medium text-white bg-cocktail-primary border border-cocktail-primary rounded-md">
                        {{ num }}
                    </span>
                {% else %}
                    <a href="?page={{ num }}{% if current_filter != 'all' %}&filter={{ current_filter }}{% endif %}{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}&page_size={{ current_page_size }}" 
                       class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700">
                        {{ num }}
                    </a>
                {% endif %}
            {% endfor %}
            
            {% if cocktails.has_next %}
                <a href="?page={{ cocktails.next_page_number }}{% if current_filter != 'all' %}&filter={{ current_filter }}{% endif %}{% if current_sort != 'date_desc' %}&sort={{ current_sort }}{% endif %}&page_size={{ current_page_size }}" 
                   class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700">
                    Suivant
                </a>
            {% endif %}
        </nav>
    </div>
    {% endif %}
    
    {% else %}
    <!-- √âtat vide -->
    <div class="text-center py-16">
        <div class="text-6xl mb-4">üçπ</div>
        <h3 class="text-2xl font-bold text-gray-900 mb-2">Aucun cocktail cr√©√©</h3>
        <p class="text-gray-600 mb-8">Vous n'avez pas encore cr√©√© de cocktail. Commencez d√®s maintenant !</p>
        <a href="{% url 'cocktails:generate' %}" class="bg-cocktail-primary hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-200 inline-flex items-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
            Cr√©er mon premier cocktail
        </a>
    </div>
    {% endif %}
</div>

{% block extra_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Toggle mobile stats collapse
    const mobileStatsToggle = document.getElementById('mobile-stats-toggle');
    const statsContent = document.getElementById('stats-content');
    const statsChevron = document.getElementById('stats-chevron');
    
    if (mobileStatsToggle && statsContent && statsChevron) {
        // Set initial state - collapsed on mobile by default
        if (window.innerWidth < 640) {
            statsContent.classList.add('hidden');
            statsContent.style.maxHeight = '0';
            statsChevron.style.transform = 'rotate(0deg)';
            mobileStatsToggle.setAttribute('aria-expanded', 'false');
        } else {
            // Desktop - always expanded
            statsContent.classList.remove('hidden');
            statsContent.style.maxHeight = 'none';
            mobileStatsToggle.setAttribute('aria-expanded', 'true');
        }
        
        mobileStatsToggle.addEventListener('click', function() {
            // Only toggle on mobile
            if (window.innerWidth >= 640) return;
            
            if (statsContent.classList.contains('hidden')) {
                // Show stats
                statsContent.classList.remove('hidden');
                statsContent.style.maxHeight = statsContent.scrollHeight + 'px';
                statsChevron.style.transform = 'rotate(180deg)';
                this.setAttribute('aria-expanded', 'true');
            } else {
                // Hide stats
                statsContent.style.maxHeight = '0';
                statsChevron.style.transform = 'rotate(0deg)';
                this.setAttribute('aria-expanded', 'false');
                
                // Wait for transition to complete before adding hidden class
                setTimeout(() => {
                    statsContent.classList.add('hidden');
                }, 300);
            }
        });
        
        // Handle window resize for stats
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 640) {
                // Desktop - always show stats
                statsContent.classList.remove('hidden');
                statsContent.style.maxHeight = 'none';
                statsChevron.style.transform = 'rotate(0deg)';
                mobileStatsToggle.setAttribute('aria-expanded', 'true');
            } else {
                // Mobile - reset to collapsed state
                statsContent.classList.add('hidden');
                statsContent.style.maxHeight = '0';
                statsChevron.style.transform = 'rotate(0deg)';
                mobileStatsToggle.setAttribute('aria-expanded', 'false');
            }
        });
    }

    // Toggle mobile filters collapse
    const mobileFiltersToggle = document.getElementById('mobile-filters-toggle');
    const filtersContent = document.getElementById('filters-content');
    const chevron = document.getElementById('filters-chevron');
    
    if (mobileFiltersToggle && filtersContent && chevron) {
        // Set initial state - collapsed on mobile by default
        if (window.innerWidth < 640) {
            filtersContent.classList.add('hidden');
            filtersContent.style.maxHeight = '0';
            chevron.style.transform = 'rotate(0deg)';
            mobileFiltersToggle.setAttribute('aria-expanded', 'false');
        } else {
            // Desktop - always expanded
            filtersContent.classList.remove('hidden');
            filtersContent.style.maxHeight = 'none';
            mobileFiltersToggle.setAttribute('aria-expanded', 'true');
        }
        
        mobileFiltersToggle.addEventListener('click', function() {
            // Only toggle on mobile
            if (window.innerWidth >= 640) return;
            
            if (filtersContent.classList.contains('hidden')) {
                // Show filters
                filtersContent.classList.remove('hidden');
                filtersContent.style.maxHeight = filtersContent.scrollHeight + 'px';
                chevron.style.transform = 'rotate(180deg)';
                this.setAttribute('aria-expanded', 'true');
            } else {
                // Hide filters
                filtersContent.style.maxHeight = '0';
                chevron.style.transform = 'rotate(0deg)';
                this.setAttribute('aria-expanded', 'false');
                
                // Wait for transition to complete before adding hidden class
                setTimeout(() => {
                    filtersContent.classList.add('hidden');
                }, 300);
            }
        });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 640) {
                // Desktop - always show
                filtersContent.classList.remove('hidden');
                filtersContent.style.maxHeight = 'none';
                chevron.style.transform = 'rotate(0deg)';
                mobileFiltersToggle.setAttribute('aria-expanded', 'true');
            } else {
                // Mobile - reset to collapsed state
                filtersContent.classList.add('hidden');
                filtersContent.style.maxHeight = '0';
                chevron.style.transform = 'rotate(0deg)';
                mobileFiltersToggle.setAttribute('aria-expanded', 'false');
            }
        });
    }

    // D√©tection de la taille d'√©cran pour pagination dynamique
    function getOptimalPageSize() {
        return window.innerWidth >= 1536 ? 8 : 6;
    }
    
    // Fonction pour recharger avec la bonne pagination
    function adjustPaginationForScreenSize() {
        const currentUrl = new URL(window.location);
        const currentPageSize = getOptimalPageSize();
        const urlPageSize = currentUrl.searchParams.get('page_size');
        
        // Si la taille de page n'est pas optimale pour l'√©cran actuel, recharger
        if (urlPageSize != currentPageSize) {
            currentUrl.searchParams.set('page_size', currentPageSize);
            currentUrl.searchParams.delete('page'); // Retour √† la page 1
            window.location.href = currentUrl.toString();
        }
    }
    
    // Ajuster au chargement de la page
    adjustPaginationForScreenSize();
    
    // Ajuster lors du redimensionnement de la fen√™tre (avec debounce)
    let resizeTimeout;
    window.addEventListener('resize', function() {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(adjustPaginationForScreenSize, 300);
    });

    // Ajouter automatiquement page_size √† tous les liens de navigation
    function addPageSizeToLinks() {
        const pageSize = getOptimalPageSize();
        const links = document.querySelectorAll('a[href*="?"]');
        
        links.forEach(link => {
            const url = new URL(link.href);
            if (url.pathname === window.location.pathname) {
                url.searchParams.set('page_size', pageSize);
                link.href = url.toString();
            }
        });
    }
    
    // Appliquer aux liens existants
    addPageSizeToLinks();

    // Gestion du tri dynamique
    const sortSelect = document.getElementById('sort-select');
    if (sortSelect) {
        sortSelect.addEventListener('change', function() {
            const currentUrl = new URL(window.location);
            currentUrl.searchParams.set('sort', this.value);
            currentUrl.searchParams.set('page_size', getOptimalPageSize()); // Maintenir la bonne taille de page
            // Retour √† la page 1 quand on change le tri
            currentUrl.searchParams.delete('page');
            window.location.href = currentUrl.toString();
        });
    }
    
    // Carousel mobile functionality
    const carousel = document.getElementById('cocktail-carousel');
    const carouselTrack = document.getElementById('carousel-track');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const progressBar = document.getElementById('progress-bar');
    
    if (carousel && carouselTrack) {
        let currentSlide = 0;
        const totalSlides = carouselTrack.children.length;
        let startX = 0;
        let currentX = 0;
        let isDragging = false;
        
        function updateCarousel() {
            const translateX = -currentSlide * 100;
            carouselTrack.style.transform = `translateX(${translateX}%)`;
            
            // Update slide counter
            const slideCounter = document.getElementById('current-slide-number');
            if (slideCounter) {
                slideCounter.textContent = currentSlide + 1;
            }
            
            // Update progress bar
            if (progressBar && totalSlides > 0) {
                const progressPercent = ((currentSlide + 1) / totalSlides) * 100;
                progressBar.style.width = `${progressPercent}%`;
            }
        }
        
        // Initialize progress bar
        if (progressBar && totalSlides > 0) {
            const initialProgress = (1 / totalSlides) * 100;
            progressBar.style.width = `${initialProgress}%`;
        }
        
        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        }
        
        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateCarousel();
        }
        
        // Button navigation
        if (nextBtn) nextBtn.addEventListener('click', nextSlide);
        if (prevBtn) prevBtn.addEventListener('click', prevSlide);
        
        // Touch/swipe functionality
        carousel.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            isDragging = true;
            carouselTrack.style.transition = 'none';
        });
        
        carousel.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            currentX = e.touches[0].clientX;
            const diffX = currentX - startX;
            const currentTranslate = -currentSlide * 100;
            const newTranslate = currentTranslate + (diffX / carousel.offsetWidth) * 100;
            carouselTrack.style.transform = `translateX(${newTranslate}%)`;
        });
        
        carousel.addEventListener('touchend', (e) => {
            if (!isDragging) return;
            isDragging = false;
            carouselTrack.style.transition = 'transform 0.3s ease-in-out';
            
            const diffX = currentX - startX;
            const threshold = carousel.offsetWidth * 0.2; // 20% of carousel width
            
            if (Math.abs(diffX) > threshold) {
                if (diffX > 0) {
                    prevSlide();
                } else {
                    nextSlide();
                }
            } else {
                updateCarousel(); // Snap back to current slide
            }
        });
        
        // Mouse events for desktop testing
        carousel.addEventListener('mousedown', (e) => {
            startX = e.clientX;
            isDragging = true;
            carouselTrack.style.transition = 'none';
            e.preventDefault();
        });
        
        carousel.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            currentX = e.clientX;
            const diffX = currentX - startX;
            const currentTranslate = -currentSlide * 100;
            const newTranslate = currentTranslate + (diffX / carousel.offsetWidth) * 100;
            carouselTrack.style.transform = `translateX(${newTranslate}%)`;
        });
        
        carousel.addEventListener('mouseup', (e) => {
            if (!isDragging) return;
            isDragging = false;
            carouselTrack.style.transition = 'transform 0.3s ease-in-out';
            
            const diffX = currentX - startX;
            const threshold = carousel.offsetWidth * 0.2;
            
            if (Math.abs(diffX) > threshold) {
                if (diffX > 0) {
                    prevSlide();
                } else {
                    nextSlide();
                }
            } else {
                updateCarousel();
            }
        });
        
        carousel.addEventListener('mouseleave', () => {
            if (isDragging) {
                isDragging = false;
                carouselTrack.style.transition = 'transform 0.3s ease-in-out';
                updateCarousel();
            }
        });
        
        // Auto-play (optional)
        let autoPlayInterval;
        function startAutoPlay() {
            autoPlayInterval = setInterval(nextSlide, 5000); // Change slide every 5 seconds
        }
        
        function stopAutoPlay() {
            clearInterval(autoPlayInterval);
        }
        
        // Pause auto-play on interaction
        carousel.addEventListener('touchstart', stopAutoPlay);
        carousel.addEventListener('mouseenter', stopAutoPlay);
        carousel.addEventListener('mouseleave', startAutoPlay);
        
        // Start auto-play if there are multiple slides
        if (totalSlides > 1) {
            startAutoPlay();
        }
    }
    
    // Animation d'apparition des cartes (Desktop only)
    const cocktailCards = document.querySelectorAll('.cocktail-card');
    cocktailCards.forEach((card, index) => {
        // Only animate desktop cards
        if (window.innerWidth >= 640) {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
                card.style.transition = 'all 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 100);
        }
    });

    // Gestion des boutons favoris
    const favoriteButtons = document.querySelectorAll('.favorite-btn');
    favoriteButtons.forEach(btn => {
        btn.addEventListener('click', async function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const cocktailId = this.dataset.cocktailId;
            const isFavorite = this.dataset.isFavorite === 'true';
            const heartIcon = this.querySelector('svg');
            
            // D√©sactiver temporairement le bouton
            this.disabled = true;
            this.style.opacity = '0.7';

            try {
                const response = await fetch(`{% url 'cocktails:toggle_favorite' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', cocktailId), {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}',
                    },
                });

                if (response.ok) {
                    const data = await response.json();
                    
                    // Mettre √† jour l'√©tat du bouton
                    this.dataset.isFavorite = data.is_favorite;
                    
                    // Mettre √† jour l'ic√¥ne
                    if (data.is_favorite) {
                        // C≈ìur plein (favori)
                        heartIcon.innerHTML = '<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>';
                        heartIcon.setAttribute('class', 'w-5 h-5 fill-current text-red-500');
                        heartIcon.setAttribute('fill', 'currentColor');
                        heartIcon.removeAttribute('stroke');
                    } else {
                        // C≈ìur vide (pas favori)
                        heartIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>';
                        heartIcon.setAttribute('class', 'w-5 h-5');
                        heartIcon.setAttribute('fill', 'none');
                        heartIcon.setAttribute('stroke', 'currentColor');
                    }
                    
                    // Animation du bouton
                    this.classList.add('scale-125');
                    setTimeout(() => {
                        this.classList.remove('scale-125');
                    }, 200);
                    
                    // Toast notification
                    const message = data.is_favorite ? 'Ajout√© aux favoris ‚ù§Ô∏è' : 'Retir√© des favoris üíî';
                    showToast(message);
                    
                    // Si on est sur la page des favoris et que le cocktail n'est plus favori,
                    // on peut le faire dispara√Ætre avec animation
                    if (!data.is_favorite && window.location.search.includes('filter=favorites')) {
                        const card = this.closest('.cocktail-card');
                        card.style.transition = 'all 0.5s ease';
                        card.style.opacity = '0';
                        card.style.transform = 'scale(0.8)';
                        setTimeout(() => {
                            // Recharger la page pour mettre √† jour le compteur
                            window.location.reload();
                        }, 500);
                    }
                    
                } else {
                    console.error('Erreur lors de la mise √† jour des favoris');
                    showToast('Erreur lors de la mise √† jour', 'error');
                }
            } catch (error) {
                console.error('Erreur r√©seau:', error);
                showToast('Erreur de connexion', 'error');
            } finally {
                // R√©activer le bouton
                this.disabled = false;
                this.style.opacity = '1';
            }
        });
    });

    // Fonction pour afficher des messages toast
    function showToast(message, type = 'success') {
        const toast = document.createElement('div');
        toast.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-lg text-white transition-all duration-300 transform translate-x-full ${
            type === 'error' ? 'bg-red-500' : 'bg-green-500'
        }`;
        toast.textContent = message;
        document.body.appendChild(toast);
        
        // Animation d'entr√©e
        setTimeout(() => {
            toast.style.transform = 'translateX(0)';
        }, 100);
        
        // Suppression automatique
        setTimeout(() => {
            toast.style.transform = 'translateX(full)';
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 300);
        }, 3000);
    }
});

// Animation CSS
const style = document.createElement('style');
style.textContent = `
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .favorite-btn {
        transition: all 0.2s ease;
    }

    .favorite-btn:hover {
        transform: scale(1.1);
    }
    
    /* Mobile collapse transitions */
    #filters-content {
        transition: max-height 0.3s ease-in-out;
        overflow: hidden;
    }
    
    #filters-chevron {
        transition: transform 0.3s ease-in-out;
    }
    
    /* Ensure smooth transitions on mobile toggle button */
    #mobile-filters-toggle {
        transition: background-color 0.2s ease;
    }
    
    /* Stats collapse transitions */
    #stats-content {
        transition: max-height 0.3s ease-in-out;
        overflow: hidden;
    }
    
    #stats-chevron {
        transition: transform 0.3s ease-in-out;
    }
    
    /* Stats toggle button */
    #mobile-stats-toggle {
        transition: background-color 0.2s ease;
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}

{% endblock %}
